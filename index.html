<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Light ws2812 by cpldcpu</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Light ws2812</h1>
        <p>Light weight library to control WS2811/WS2812 based LEDS and LED Strings for 8-Bit AVR microcontrollers.</p>

        <p class="view"><a href="https://github.com/cpldcpu/light_ws2812">View the Project on GitHub <small>cpldcpu/light_ws2812</small></a></p>


        <ul>
          <li><a href="https://github.com/cpldcpu/light_ws2812/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/cpldcpu/light_ws2812/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/cpldcpu/light_ws2812">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="light_ws2812" class="anchor" href="#light_ws2812"><span class="octicon octicon-link"></span></a>light_ws2812</h1>

<p>Light weight library to control WS2811/WS2812 based LEDS and LED Strings for 8-Bit AVR microcontrollers.</p>

<h1>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>Description</h1>

<p>This is a small Ansi-C library to control WS2811/WS2812 based RGB Leds and strings. Only the 800kHz
high-speed mode is supported. This library uses a bit-banging approach with cycle optimized assembler
innerloops. Some advantages of this approach compared to existing solutions are:</p>

<ul>
<li>Compatible to all AVR MCUs since it does not rely on special periphery.</li>
<li>Low hardware footprint: Does not rely on any timer or the USI</li>
<li>Much smaller program code: Size optimized assembler without unrolled loops (&lt;50 bytes in most cases)</li>
<li>No initialization required</li>
<li>Carefully optimized to use instructions which are available on all AVR cores and have the same instruction timing across all devices.</li>
<li>Supports standard AVR, reduced core AVR (Attiny 4/5/9/10/20/40) and XMEGA (untested) without special case handling.</li>
<li>Arduino or C++ not required</li>
<li>Clock speeds down to 4Mhz supported.</li>
</ul><p>A disadvantage of this approach is that the code has to be hand optimized for each CPU clockspeed. 
However, a number of different routines are provided which support CPU clocks from 4Mhz to 16Mhz.</p>

<h1>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h1>

<ul>
<li>Add "light_ws2812.c" and "light_ws2812.h" to your project.</li>
<li>Make sure optimizations are enabled in the compiler.</li>
<li>Change ws2812_port and ws2812_pin in the include file according to the I/O pin you are using.</li>
<li>Uncomment the #define appropiate for your clock settings. If your exact clock is not supported, 
try a higher or lower clock setting. The WS2811 controller chip is tolerant to some timing inaccuracy.</li>
<li>Set the data output register for the output pin you are using.</li>
<li>Call "ws2812_sendarray" with a pointer to your LED data and the number of bytes to transmit.
Each LED receives 3 bytes in Green-Red-Blue order. Therefore the total number of bytes should
be three times the number of LEDs in the chain.</li>
<li>Alternatively you can use ws2813_sendarray_mask, which allows to specify one or more output pins
on the same port.</li>
<li>Wait for at least 50 us before the next LED update to reset the chain.</li>
</ul><p>A simple example is provided in "test_rgb_blinky.c"</p>

<h1>
<a name="release-history" class="anchor" href="#release-history"><span class="octicon octicon-link"></span></a>Release History</h1>

<ul>
<li>v0.3 2013/05/06 

<ul>
<li>Initial release. Thanks to "Matthias H." for testing with a longer led chain.</li>
</ul>
</li>
<li>v0.4 2013/05/07 

<ul>
<li>General clean up </li>
<li>Some code size optimizations. Thanks to "Fallobst" for suggestions </li>
<li>Disabled interrupts in the critical sections.</li>
</ul>
</li>
<li>v0.5 2013/05/20

<ul>
<li>Fixed timing bug from size optimization</li>
</ul>
</li>
<li>v0.6 2013/05/27

<ul>
<li>Major update: Changed all port accesses from SBI/CBI to OUT. This removes 
a timing inconsistency between reduced core AVR and standard AVR, avoiding separate
implementations for different cores. A disadvantage is increase register usage.</li>
<li>Added the "ws2812_sendarray_mask" function which allows to pass a bitmask for the
selected port. This allows controlling up to 8 independent LED strips.</li>
<li>Removed functions for interrupt handling. Avoiding interference with interrupts
is now up to the user. </li>
<li>4 MHz clock speed is now also supported for standard core AVRs.</li>
</ul>
</li>
<li>v0.7 2013/05/28

<ul>
<li>Optimized timing and size of 8 and 12 Mhz routines. All routines are within 
datasheet specs now, except of 9.6 Mhz which is marginally off but works under
all test conditions<br>
</li>
</ul>
</li>
<li>
<p>v0.8 2013/06/03</p>

<ul>
<li>9.6 Mhz implementation now within specifications.</li>
<li>brvs-&gt;brcs. Loops terminate correctly (thanks to Mario Pieschel).</li>
</ul>
<h1>
<a name="tested-combinations" class="anchor" href="#tested-combinations"><span class="octicon octicon-link"></span></a>Tested Combinations</h1>
</li>
</ul><table>
<tr>
<th>Device</th>
<th align="center">4 MHz</th>
<th align="center">8 MHz</th>
<th align="center">9.6 MHz</th>
<th align="center">12 MHz</th>
<th align="center">16 MHz</th>
</tr>
<tr>
<td>ATtiny 85 (Standard Core )</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
</tr>
<tr>
<td>ATtiny 13 (Standard Core)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>ATmega 8 (Standard Core)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
</tr>
<tr>
<td>ATtiny 10 (Reduced Core)</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</table><p>Please find updates on <a href="https://github.com/cpldcpu/light_ws2812">https://github.com/cpldcpu/light_ws2812</a></p>

<p>bug reports etc: <a href="mailto:cpldcpu@gmail.com">cpldcpu@gmail.com</a></p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/cpldcpu">cpldcpu</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>